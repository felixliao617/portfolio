---
import '../styles/global.css';

import photos from '../data/photos.json';
import videos from '../data/videos.json';
import projects from '../data/projects.json';

const siteConfig = {
  name: "Nikita Lin",
  roles: ["Director", "Photographer", "Software Engineer"],
  email: "nikitalin126@gmail.com",
  linkedin: "https://www.linkedin.com/in/nikitalin/",
  github: "https://github.com/fnnikita",
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={`${siteConfig.name} - ${siteConfig.roles.join(', ')}`} />
    <title>{siteConfig.name} | Portfolio</title>
  </head>
  <body>
    <!-- Theme Toggle -->
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
      <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="4"/>
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
      </svg>
      <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
      </svg>
    </button>

    <!-- Main Canvas -->
    <main class="canvas" id="canvas">
      <!-- Connected Elements Layout -->
      <div class="constellation">
        <!-- SVG Connection Lines -->
        <svg class="connection-lines" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid meet">
          <!-- Lines from center to icons -->
          <line class="conn-line conn-line--video" x1="400" y1="300" x2="200" y2="150" />
          <line class="conn-line conn-line--photo" x1="400" y1="300" x2="600" y2="150" />
          <line class="conn-line conn-line--code" x1="400" y1="300" x2="400" y2="480" />

          <!-- Decorative dots on lines -->
          <circle class="conn-dot conn-dot--video" cx="300" cy="225" r="3" />
          <circle class="conn-dot conn-dot--photo" cx="500" cy="225" r="3" />
          <circle class="conn-dot conn-dot--code" cx="400" cy="390" r="3" />
        </svg>

        <!-- Center: Name -->
        <div class="center-hub">
          <h1 class="name">{siteConfig.name}</h1>
        </div>

        <!-- Video Camera Icon - Red -->
        <button class="icon-node icon-node--video" data-category="video" aria-label="View Director work">
          <div class="icon-wrapper">
            <svg class="icon-svg" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <!-- Video Camera -->
              <rect x="8" y="18" width="32" height="28" rx="4" />
              <path d="M40 28 L56 18 L56 46 L40 36" />
              <circle cx="20" cy="32" r="6" />
              <line x1="14" y1="18" x2="14" y2="12" />
              <circle cx="14" cy="10" r="2" />
            </svg>
          </div>
          <span class="icon-label">Director</span>
        </button>

        <!-- Camera Icon - Blue -->
        <button class="icon-node icon-node--photo" data-category="photography" aria-label="View Photography">
          <div class="icon-wrapper">
            <svg class="icon-svg" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <!-- Photo Camera -->
              <rect x="6" y="20" width="52" height="36" rx="4" />
              <circle cx="32" cy="38" r="12" />
              <circle cx="32" cy="38" r="6" />
              <path d="M20 20 L24 12 L40 12 L44 20" />
              <circle cx="48" cy="28" r="3" />
            </svg>
          </div>
          <span class="icon-label">Photographer</span>
        </button>

        <!-- Keyboard Icon - Green -->
        <button class="icon-node icon-node--code" data-category="code" aria-label="View Code Projects">
          <span class="icon-label icon-label--top">Software Engineer</span>
          <div class="icon-wrapper">
            <svg class="icon-svg" viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <!-- Keyboard -->
              <rect x="4" y="18" width="56" height="32" rx="4" />
              <!-- Top row keys -->
              <rect x="8" y="22" width="6" height="5" rx="1" />
              <rect x="16" y="22" width="6" height="5" rx="1" />
              <rect x="24" y="22" width="6" height="5" rx="1" />
              <rect x="32" y="22" width="6" height="5" rx="1" />
              <rect x="40" y="22" width="6" height="5" rx="1" />
              <rect x="48" y="22" width="8" height="5" rx="1" />
              <!-- Middle row -->
              <rect x="8" y="29" width="8" height="5" rx="1" />
              <rect x="18" y="29" width="6" height="5" rx="1" />
              <rect x="26" y="29" width="6" height="5" rx="1" />
              <rect x="34" y="29" width="6" height="5" rx="1" />
              <rect x="42" y="29" width="6" height="5" rx="1" />
              <rect x="50" y="29" width="6" height="5" rx="1" />
              <!-- Space bar -->
              <rect x="16" y="36" width="32" height="5" rx="1" />
              <!-- Bottom corners -->
              <rect x="8" y="36" width="6" height="5" rx="1" />
              <rect x="50" y="36" width="6" height="5" rx="1" />
              <!-- Arrow hint -->
              <path d="M10 44 L14 46 L10 48" />
              <path d="M54 44 L50 46 L54 48" />
            </svg>
          </div>
        </button>
      </div>

      <!-- Social Links -->
      <nav class="social-links">
        <a href={`mailto:${siteConfig.email}`} class="social-link" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="20" height="16" x="2" y="4" rx="2"/>
            <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
          </svg>
        </a>
        <a href={siteConfig.linkedin} class="social-link" target="_blank" rel="noopener noreferrer" title="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
            <rect width="4" height="12" x="2" y="9"/>
            <circle cx="4" cy="4" r="2"/>
          </svg>
        </a>
        <a href={siteConfig.github} class="social-link" target="_blank" rel="noopener noreferrer" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/>
            <path d="M9 18c-4.51 2-5-2-7-2"/>
          </svg>
        </a>
      </nav>
    </main>

    <!-- Expanded Content Panel -->
    <div class="panel" id="panel" aria-hidden="true">
      <button class="panel-close" id="panelClose" aria-label="Close panel">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 6 6 18"/>
          <path d="m6 6 12 12"/>
        </svg>
      </button>

      <div class="panel-header">
        <h2 class="panel-title" id="panelTitle"></h2>
      </div>

      <div class="panel-content" id="panelContent">
        <!-- Photography Content - 3D Gallery -->
        <div class="content-section" id="content-photography" hidden>
          <div class="gallery-3d">
            <div class="gallery-room">
              {photos.map((photo, index) => (
                <div
                  class="gallery-frame"
                  data-index={index}
                  data-fullsize={photo.fullsize}
                  data-title={photo.title}
                  style={`--i: ${index}`}
                >
                  <div class="frame-border">
                    <img src={photo.thumbnail} alt={photo.title} loading="lazy" />
                  </div>
                  <div class="frame-label">{photo.title}</div>
                </div>
              ))}
            </div>
            <div class="gallery-nav">
              <button class="gallery-nav-btn" id="galleryPrev" aria-label="Previous">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="m15 18-6-6 6-6"/>
                </svg>
              </button>
              <span class="gallery-counter"><span id="currentIndex">1</span> / {photos.length}</span>
              <button class="gallery-nav-btn" id="galleryNext" aria-label="Next">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="m9 18 6-6-6-6"/>
                </svg>
              </button>
            </div>
            <p class="gallery-hint">Scroll or use arrow keys to navigate</p>
          </div>
        </div>

        <!-- Video Content - Cinema Style -->
        <div class="content-section" id="content-video" hidden>
          <div class="cinema">
            <!-- Cinema ambient light -->
            <div class="cinema-glow"></div>

            <!-- Screen area -->
            <div class="cinema-screen-container">
              {videos.map((video, index) => (
                <div class="cinema-screen" data-index={index} data-video-id={video.url.split('v=')[1]?.split('&')[0] || ''}>
                  <div class="screen-frame">
                    <img src={video.thumbnail} alt={video.title} class="screen-thumbnail" />
                    <button class="screen-play-btn" aria-label="Play video">
                      <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="white">
                        <polygon points="5 3 19 12 5 21 5 3"/>
                      </svg>
                    </button>
                    <div class="screen-video" hidden>
                      <iframe
                        width="100%"
                        height="100%"
                        src=""
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                      </iframe>
                    </div>
                  </div>
                  <div class="screen-info">
                    <h3>{video.title}</h3>
                    <p>{video.description}</p>
                  </div>
                </div>
              ))}
            </div>

            <!-- Cinema navigation -->
            {videos.length > 1 && (
              <div class="cinema-nav">
                <button class="cinema-nav-btn" id="cinemaPrev" aria-label="Previous">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m15 18-6-6 6-6"/>
                  </svg>
                </button>
                <span class="cinema-counter"><span id="cinemaIndex">1</span> / {videos.length}</span>
                <button class="cinema-nav-btn" id="cinemaNext" aria-label="Next">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m9 18 6-6-6-6"/>
                  </svg>
                </button>
              </div>
            )}

            <!-- Cinema seats - foreground silhouettes -->
            <div class="cinema-foreground">
              <!-- Back row (smaller, further away) -->
              <div class="audience-row row-back">
                <div class="person-silhouette"></div>
                <div class="person-silhouette"></div>
                <div class="person-silhouette tall"></div>
                <div class="person-silhouette"></div>
                <div class="person-silhouette"></div>
              </div>
              <!-- Front row (large, close to viewer) -->
              <div class="audience-row row-front">
                <div class="person-silhouette large"></div>
                <div class="person-silhouette large tall"></div>
                <div class="person-silhouette large"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Code Content -->
        <div class="content-section" id="content-code" hidden>
          <div class="projects-grid">
            {projects.map((project) => (
              <article class="project-card">
                <h3>{project.title}</h3>
                <p>{project.description}</p>
                <div class="project-tech">
                  {project.tech.map((tech) => (
                    <span class="tech-tag">{tech}</span>
                  ))}
                </div>
                <div class="project-links">
                  <a href={project.github} target="_blank" rel="noopener noreferrer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/>
                      <path d="M9 18c-4.51 2-5-2-7-2"/>
                    </svg>
                    Code
                  </a>
                  {project.demo && (
                    <a href={project.demo} target="_blank" rel="noopener noreferrer" class="demo-link">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                        <polyline points="15 3 21 3 21 9"/>
                        <line x1="10" x2="21" y1="14" y2="3"/>
                      </svg>
                      Demo
                    </a>
                  )}
                </div>
              </article>
            ))}
          </div>
        </div>
      </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox" aria-hidden="true">
      <button class="lightbox-close" aria-label="Close">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
        </svg>
      </button>
      <img src="" alt="" id="lightboxImage" />
      <p id="lightboxTitle"></p>
    </div>

    <style>
      /* Theme Toggle */
      .theme-toggle {
        position: fixed;
        top: var(--space-lg);
        right: var(--space-lg);
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: var(--color-border);
        color: var(--color-text);
        z-index: 100;
        transition: all var(--transition-fast);
      }

      .theme-toggle:hover {
        transform: scale(1.1);
      }

      .icon-moon { display: none; }
      [data-theme="dark"] .icon-sun { display: none; }
      [data-theme="dark"] .icon-moon { display: block; }

      /* Canvas Layout */
      .canvas {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--space-xl);
        position: relative;
        transition: opacity var(--transition-slow), transform var(--transition-slow);
      }

      .canvas.hidden {
        opacity: 0;
        transform: scale(0.95);
        pointer-events: none;
      }

      /* Constellation Layout */
      .constellation {
        position: relative;
        width: 100%;
        max-width: 700px;
        height: 500px;
      }

      /* Connection Lines */
      .connection-lines {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }

      .conn-line {
        stroke: var(--color-border);
        stroke-width: 1.5;
        stroke-dasharray: 8 4;
        transition: stroke var(--transition-normal);
      }

      .conn-line--video { stroke: var(--color-red); opacity: 0.4; }
      .conn-line--photo { stroke: var(--color-blue); opacity: 0.4; }
      .conn-line--code { stroke: var(--color-green); opacity: 0.4; }

      .conn-dot {
        transition: all var(--transition-normal);
      }
      .conn-dot--video { fill: var(--color-red); }
      .conn-dot--photo { fill: var(--color-blue); }
      .conn-dot--code { fill: var(--color-green); }

      /* Animate connection lines */
      @keyframes dash {
        to { stroke-dashoffset: -24; }
      }

      .conn-line {
        animation: dash 2s linear infinite;
      }

      /* Center Hub */
      .center-hub {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        z-index: 10;
      }

      .name {
        font-size: clamp(2rem, 5vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.03em;
        background: linear-gradient(135deg, var(--color-text) 0%, var(--color-text-muted) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Icon Nodes */
      .icon-node {
        position: absolute;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--space-sm);
        transition: all var(--transition-normal);
      }

      .icon-wrapper {
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-lg);
        background: var(--color-bg);
        border: 2px solid var(--color-border);
        transition: all var(--transition-normal);
      }

      .icon-svg {
        width: 48px;
        height: 48px;
        transition: all var(--transition-normal);
      }

      .icon-label {
        font-size: 0.875rem;
        font-weight: 500;
        transition: all var(--transition-fast);
        white-space: nowrap;
      }

      .icon-label--top {
        order: -1;
      }

      /* Video Camera - Red (Top Left) */
      .icon-node--video {
        left: 12%;
        top: 8%;
      }

      .icon-node--video .icon-svg {
        stroke: var(--color-red);
      }

      .icon-node--video .icon-label {
        color: var(--color-red);
      }

      .icon-node--video:hover .icon-wrapper {
        border-color: var(--color-red);
        box-shadow: 0 8px 30px rgba(234, 67, 53, 0.25);
        transform: scale(1.1);
      }

      .icon-node--video:hover .icon-label {
        transform: scale(1.05);
      }

      /* Photo Camera - Blue (Top Right) */
      .icon-node--photo {
        right: 12%;
        top: 8%;
      }

      .icon-node--photo .icon-svg {
        stroke: var(--color-blue);
      }

      .icon-node--photo .icon-label {
        color: var(--color-blue);
      }

      .icon-node--photo:hover .icon-wrapper {
        border-color: var(--color-blue);
        box-shadow: 0 8px 30px rgba(66, 133, 244, 0.25);
        transform: scale(1.1);
      }

      .icon-node--photo:hover .icon-label {
        transform: scale(1.05);
      }

      /* Keyboard - Green (Bottom Center) */
      .icon-node--code {
        left: 50%;
        bottom: 5%;
        transform: translateX(-50%);
      }

      .icon-node--code .icon-svg {
        stroke: var(--color-green);
      }

      .icon-node--code .icon-label {
        color: var(--color-green);
      }

      .icon-node--code:hover .icon-wrapper {
        border-color: var(--color-green);
        box-shadow: 0 8px 30px rgba(52, 168, 83, 0.25);
        transform: scale(1.1);
      }

      .icon-node--code:hover .icon-label {
        transform: scale(1.05);
      }

      .icon-node--code:hover {
        transform: translateX(-50%) scale(1);
      }

      /* Hover effects on connection lines */
      .icon-node--video:hover ~ .connection-lines .conn-line--video,
      .icon-node--photo:hover ~ .connection-lines .conn-line--photo,
      .icon-node--code:hover ~ .connection-lines .conn-line--code {
        opacity: 1;
        stroke-width: 2;
      }

      /* Social Links */
      .social-links {
        position: fixed;
        bottom: var(--space-xl);
        display: flex;
        gap: var(--space-md);
      }

      .social-link {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        color: var(--color-text-muted);
        transition: all var(--transition-fast);
      }

      .social-link:hover {
        color: var(--color-text);
        background: var(--color-border);
        transform: translateY(-2px);
      }

      /* Panel */
      .panel {
        position: fixed;
        inset: 0;
        background: var(--color-bg);
        z-index: 200;
        opacity: 0;
        visibility: hidden;
        transform: translateY(100%);
        transition: all var(--transition-slow);
        overflow-y: auto;
        padding: var(--space-xl);
      }

      .panel.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      /* Photography panel - full black background */
      .panel:has(#content-photography:not([hidden])) {
        background: #0a0a0a;
      }

      .panel:has(#content-photography:not([hidden])) .panel-close {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .panel:has(#content-photography:not([hidden])) .panel-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .panel-close {
        position: fixed;
        top: var(--space-lg);
        right: var(--space-lg);
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: var(--color-border);
        color: var(--color-text);
        z-index: 210;
        transition: all var(--transition-fast);
      }

      .panel-close:hover {
        transform: scale(1.1) rotate(90deg);
      }

      .panel-header {
        text-align: center;
        padding: var(--space-3xl) 0;
      }

      .panel-title {
        font-size: clamp(2rem, 5vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.02em;
      }

      .panel-title.photography { color: var(--color-blue); }
      .panel-title.video { color: var(--color-red); }
      .panel-title.code { color: var(--color-green); }

      .panel-content {
        max-width: 1200px;
        margin: 0 auto;
      }

      /* 3D Gallery */
      .gallery-3d {
        position: relative;
        width: 100%;
        height: calc(100vh - 120px);
        min-height: 500px;
        perspective: 1200px;
        overflow: hidden;
        background: transparent;
      }

      /* Hide title for photography */
      .panel:has(#content-photography:not([hidden])) .panel-header {
        display: none;
      }

      .gallery-room {
        position: absolute;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .gallery-frame {
        position: absolute;
        left: 50%;
        top: 50%;
        transform-style: preserve-3d;
        cursor: pointer;
        transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .gallery-frame .frame-border {
        background: #111;
        padding: 12px;
        box-shadow:
          0 4px 30px rgba(0, 0, 0, 0.8),
          0 0 80px rgba(0, 0, 0, 0.5);
        border-radius: 2px;
      }

      .gallery-frame img {
        max-height: 60vh;
        max-width: 75vw;
        width: auto;
        height: auto;
        display: block;
        border-radius: 1px;
        object-fit: contain;
      }

      .gallery-frame .frame-label {
        text-align: center;
        margin-top: 20px;
        font-size: 0.8125rem;
        color: rgba(255, 255, 255, 0.4);
        letter-spacing: 0.1em;
        text-transform: uppercase;
        font-weight: 300;
        opacity: 0;
        transition: opacity 0.4s ease;
      }

      /* Active frame */
      .gallery-frame.active {
        z-index: 10;
      }

      .gallery-frame.active .frame-border {
        box-shadow:
          0 20px 60px rgba(0, 0, 0, 0.9),
          0 0 120px rgba(255, 255, 255, 0.05);
      }

      .gallery-frame.active .frame-label {
        opacity: 1;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Gallery Navigation */
      .gallery-nav {
        position: absolute;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        align-items: center;
        gap: var(--space-lg);
        z-index: 20;
      }

      .gallery-nav-btn {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all var(--transition-fast);
      }

      .gallery-nav-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .gallery-counter {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9375rem;
        font-weight: 500;
        min-width: 60px;
        text-align: center;
      }

      .gallery-hint {
        position: absolute;
        bottom: 12px;
        left: 50%;
        transform: translateX(-50%);
        color: rgba(255, 255, 255, 0.4);
        font-size: 0.75rem;
        letter-spacing: 0.05em;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .gallery-3d {
          height: 60vh;
          min-height: 400px;
        }

        .gallery-frame {
          width: 260px;
        }

        .gallery-hint {
          display: none;
        }
      }

      /* Cinema Styles */
      .panel:has(#content-video:not([hidden])) {
        background: #0a0a0a;
        padding: 0;
      }

      .panel:has(#content-video:not([hidden])) .panel-header {
        display: none;
      }

      .panel:has(#content-video:not([hidden])) .panel-close {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .panel:has(#content-video:not([hidden])) .panel-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .cinema {
        position: relative;
        width: 100%;
        height: 100vh;
        background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding-top: 8vh;
      }

      .cinema-glow {
        position: absolute;
        top: 15%;
        left: 50%;
        transform: translateX(-50%);
        width: 70%;
        height: 40%;
        background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.05) 0%, transparent 70%);
        pointer-events: none;
      }

      .cinema-screen-container {
        position: relative;
        width: 75%;
        max-width: 1000px;
        z-index: 10;
      }

      .cinema-screen {
        display: none;
      }

      .cinema-screen.active {
        display: block;
      }

      .screen-frame {
        position: relative;
        width: 100%;
        aspect-ratio: 16/9;
        background: #000;
        border-radius: 4px;
        overflow: hidden;
        box-shadow:
          0 0 0 4px #1a1a1a,
          0 0 0 6px #2a2a2a,
          0 20px 60px rgba(0, 0, 0, 0.8),
          0 0 100px rgba(255, 255, 255, 0.03);
      }

      .screen-thumbnail {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: opacity 0.3s ease;
      }

      .screen-play-btn {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: rgba(234, 67, 53, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 30px rgba(234, 67, 53, 0.4);
      }

      .screen-play-btn:hover {
        transform: translate(-50%, -50%) scale(1.1);
        background: rgba(234, 67, 53, 1);
        box-shadow: 0 8px 40px rgba(234, 67, 53, 0.6);
      }

      .screen-play-btn svg {
        margin-left: 8px;
      }

      .screen-video {
        position: absolute;
        inset: 0;
      }

      .screen-video iframe {
        width: 100%;
        height: 100%;
      }

      .screen-info {
        text-align: center;
        margin-top: 24px;
        color: white;
      }

      .screen-info h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 8px;
        color: rgba(255, 255, 255, 0.9);
      }

      .screen-info p {
        font-size: 0.9375rem;
        color: rgba(255, 255, 255, 0.5);
      }

      /* Cinema Navigation */
      .cinema-nav {
        display: flex;
        align-items: center;
        gap: var(--space-lg);
        margin-top: 24px;
        z-index: 10;
      }

      .cinema-nav-btn {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all var(--transition-fast);
      }

      .cinema-nav-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      .cinema-counter {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9375rem;
        font-weight: 500;
        min-width: 60px;
        text-align: center;
      }

      /* Cinema Foreground - Audience Silhouettes */
      .cinema-foreground {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 45vh;
        pointer-events: none;
        overflow: hidden;
      }

      .audience-row {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        align-items: flex-end;
      }

      /* Back row - smaller, higher up */
      .row-back {
        bottom: 28vh;
        gap: 30px;
      }

      .row-back .person-silhouette {
        width: 60px;
        height: 80px;
      }

      .row-back .person-silhouette::before {
        width: 28px;
        height: 32px;
        top: 0;
      }

      .row-back .person-silhouette::after {
        width: 55px;
        height: 50px;
        bottom: 0;
      }

      .row-back .person-silhouette.tall {
        height: 90px;
      }

      /* Front row - very large, fills most of width */
      .row-front {
        bottom: 0;
        gap: 8vw;
        padding: 0 5vw;
      }

      .row-front .person-silhouette.large {
        width: 25vw;
        height: 38vh;
      }

      .row-front .person-silhouette.large::before {
        width: 10vw;
        height: 12vw;
        top: 0;
      }

      .row-front .person-silhouette.large::after {
        width: 24vw;
        height: 28vh;
        bottom: 0;
      }

      .row-front .person-silhouette.large.tall {
        height: 42vh;
      }

      .row-front .person-silhouette.large.tall::after {
        height: 32vh;
      }

      /* Person silhouette base styles */
      .person-silhouette {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      /* Head */
      .person-silhouette::before {
        content: '';
        position: absolute;
        width: 50px;
        height: 55px;
        background: #0a0a0a;
        border-radius: 50% 50% 48% 48%;
        top: 0;
      }

      /* Shoulders and body */
      .person-silhouette::after {
        content: '';
        position: absolute;
        width: 90px;
        height: 70px;
        background: #0a0a0a;
        border-radius: 50% 50% 0 0;
        bottom: 0;
      }

      /* Responsive Cinema */
      @media (max-width: 768px) {
        .cinema {
          padding-top: 12vh;
        }

        .cinema-screen-container {
          width: 90%;
        }

        .screen-play-btn {
          width: 70px;
          height: 70px;
        }

        .screen-play-btn svg {
          width: 40px;
          height: 40px;
        }

        .cinema-foreground {
          height: 40vh;
        }

        .row-back {
          bottom: 22vh;
          gap: 15px;
        }

        .row-back .person-silhouette {
          width: 40px;
          height: 55px;
        }

        .row-back .person-silhouette::before {
          width: 20px;
          height: 22px;
        }

        .row-back .person-silhouette::after {
          width: 38px;
          height: 35px;
        }

        .row-front {
          gap: 5vw;
        }

        .row-front .person-silhouette.large {
          width: 28vw;
          height: 32vh;
        }

        .row-front .person-silhouette.large::before {
          width: 12vw;
          height: 14vw;
        }

        .row-front .person-silhouette.large::after {
          width: 27vw;
          height: 22vh;
        }
      }

      /* Projects Grid */
      .projects-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: var(--space-lg);
      }

      .project-card {
        padding: var(--space-lg);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        transition: all var(--transition-fast);
      }

      .project-card:hover {
        border-color: var(--color-green);
        box-shadow: var(--shadow-md);
      }

      .project-card h3 {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: var(--space-sm);
      }

      .project-card p {
        font-size: 0.9375rem;
        color: var(--color-text-muted);
        margin-bottom: var(--space-md);
        line-height: 1.6;
      }

      .project-tech {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-xs);
        margin-bottom: var(--space-md);
      }

      .tech-tag {
        font-size: 0.75rem;
        font-weight: 500;
        padding: var(--space-xs) var(--space-sm);
        background: rgba(52, 168, 83, 0.15);
        color: var(--color-green);
        border-radius: var(--radius-sm);
        font-family: var(--font-mono);
      }

      [data-theme="dark"] .tech-tag {
        background: rgba(52, 168, 83, 0.2);
      }

      .project-links {
        display: flex;
        gap: var(--space-md);
        padding-top: var(--space-md);
        border-top: 1px solid var(--color-border);
      }

      .project-links a {
        display: flex;
        align-items: center;
        gap: var(--space-xs);
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--color-text-muted);
        transition: color var(--transition-fast);
      }

      .project-links a:hover {
        color: var(--color-text);
      }

      .demo-link:hover {
        color: var(--color-green) !important;
      }

      /* Lightbox */
      .lightbox {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.95);
        z-index: 300;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: var(--space-md);
        opacity: 0;
        visibility: hidden;
        transition: all var(--transition-normal);
      }

      .lightbox.active {
        opacity: 1;
        visibility: visible;
      }

      .lightbox-close {
        position: absolute;
        top: var(--space-lg);
        right: var(--space-lg);
        color: white;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .lightbox img {
        max-width: 90vw;
        max-height: 80vh;
        object-fit: contain;
      }

      .lightbox p {
        color: white;
        font-size: 1rem;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .constellation {
          height: 550px;
        }

        .icon-wrapper {
          width: 64px;
          height: 64px;
        }

        .icon-svg {
          width: 36px;
          height: 36px;
        }

        .icon-node--video {
          left: 5%;
          top: 5%;
        }

        .icon-node--photo {
          right: 5%;
          top: 5%;
        }

        .icon-node--code {
          bottom: 8%;
        }

        .connection-lines {
          display: none;
        }

        .icon-label {
          font-size: 0.75rem;
        }
      }
    </style>

    <script>
      // Theme Toggle
      const themeToggle = document.getElementById('themeToggle');
      const html = document.documentElement;

      const savedTheme = localStorage.getItem('theme');
      const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

      if (savedTheme) {
        html.setAttribute('data-theme', savedTheme);
      } else if (systemDark) {
        html.setAttribute('data-theme', 'dark');
      }

      themeToggle?.addEventListener('click', () => {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
      });

      // Panel functionality
      const canvas = document.getElementById('canvas');
      const panel = document.getElementById('panel');
      const panelClose = document.getElementById('panelClose');
      const panelTitle = document.getElementById('panelTitle');
      const iconNodes = document.querySelectorAll('.icon-node');
      const contentSections = document.querySelectorAll('.content-section');

      const titles: Record<string, string> = {
        photography: 'Photography',
        video: 'Director',
        code: 'Software Engineering'
      };

      function openPanel(category: string, addHistory: boolean = true) {
        contentSections.forEach(section => {
          section.hidden = true;
        });

        const selectedContent = document.getElementById(`content-${category}`);
        if (selectedContent) {
          selectedContent.hidden = false;
        }

        if (panelTitle) {
          panelTitle.textContent = titles[category] || category;
          panelTitle.className = `panel-title ${category}`;
        }

        canvas?.classList.add('hidden');
        setTimeout(() => {
          panel?.classList.add('active');
          panel?.setAttribute('aria-hidden', 'false');
        }, 200);

        document.body.style.overflow = 'hidden';

        // Add to browser history
        if (addHistory) {
          history.pushState({ panel: category }, '', `#${category}`);
        }
      }

      function closePanel(goBack: boolean = false) {
        panel?.classList.remove('active');
        panel?.setAttribute('aria-hidden', 'true');

        setTimeout(() => {
          canvas?.classList.remove('hidden');
        }, 300);

        document.body.style.overflow = '';

        // Update URL
        if (!goBack && window.location.hash) {
          history.pushState({ panel: null }, '', window.location.pathname);
        }
      }

      iconNodes.forEach(el => {
        el.addEventListener('click', () => {
          const category = el.getAttribute('data-category');
          if (category) openPanel(category);
        });
      });

      panelClose?.addEventListener('click', () => closePanel());

      // Handle browser back button
      window.addEventListener('popstate', (e) => {
        if (e.state?.panel) {
          openPanel(e.state.panel, false);
        } else {
          closePanel(true);
        }
      });

      // Check URL hash on page load
      const initialHash = window.location.hash.slice(1);
      if (initialHash && ['photography', 'video', 'code'].includes(initialHash)) {
        openPanel(initialHash, false);
      }

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (lightbox?.classList.contains('active')) {
            closeLightbox();
          } else if (panel?.classList.contains('active')) {
            closePanel();
          }
        }
      });

      // Lightbox
      const lightbox = document.getElementById('lightbox');
      const lightboxImage = document.getElementById('lightboxImage') as HTMLImageElement;
      const lightboxTitle = document.getElementById('lightboxTitle');
      const lightboxClose = document.querySelector('.lightbox-close');
      const galleryItems = document.querySelectorAll('.gallery-item');

      function openLightbox(src: string, title: string) {
        if (lightboxImage) {
          lightboxImage.src = src;
          lightboxImage.alt = title;
        }
        if (lightboxTitle) {
          lightboxTitle.textContent = title;
        }
        lightbox?.classList.add('active');
        lightbox?.setAttribute('aria-hidden', 'false');
      }

      function closeLightbox() {
        lightbox?.classList.remove('active');
        lightbox?.setAttribute('aria-hidden', 'true');
      }

      galleryItems.forEach(item => {
        item.addEventListener('click', () => {
          const src = item.getAttribute('data-fullsize') || '';
          const title = item.getAttribute('data-title') || '';
          openLightbox(src, title);
        });
      });

      lightboxClose?.addEventListener('click', closeLightbox);
      lightbox?.addEventListener('click', (e) => {
        if (e.target === lightbox) closeLightbox();
      });

      // 3D Gallery
      const galleryFrames = document.querySelectorAll('.gallery-frame');
      const galleryRoom = document.querySelector('.gallery-room');
      const galleryPrev = document.getElementById('galleryPrev');
      const galleryNext = document.getElementById('galleryNext');
      const currentIndexEl = document.getElementById('currentIndex');
      const totalFrames = galleryFrames.length;
      let currentFrame = 0;

      function updateGallery() {
        galleryFrames.forEach((frame, index) => {
          const offset = index - currentFrame;
          const absOffset = Math.abs(offset);

          // Calculate 3D position
          const translateZ = -absOffset * 250;
          const translateX = offset * 400;
          const translateY = -50;
          const rotateY = offset * -30;
          const scale = absOffset === 0 ? 1.15 : Math.max(0.5, 0.85 - absOffset * 0.15);
          const opacity = absOffset > 2 ? 0 : absOffset === 0 ? 1 : 0.6 - absOffset * 0.15;

          (frame as HTMLElement).style.transform = `
            translate(-50%, ${translateY}%)
            translateX(${translateX}px)
            translateZ(${translateZ}px)
            rotateY(${rotateY}deg)
            scale(${scale})
          `;
          (frame as HTMLElement).style.opacity = String(opacity);
          frame.classList.toggle('active', offset === 0);
        });

        if (currentIndexEl) {
          currentIndexEl.textContent = String(currentFrame + 1);
        }
      }

      function nextFrame() {
        currentFrame = (currentFrame + 1) % totalFrames;
        updateGallery();
      }

      function prevFrame() {
        currentFrame = (currentFrame - 1 + totalFrames) % totalFrames;
        updateGallery();
      }

      // Initialize gallery
      if (galleryFrames.length > 0) {
        updateGallery();
      }

      galleryNext?.addEventListener('click', nextFrame);
      galleryPrev?.addEventListener('click', prevFrame);

      // Click on frame to focus
      galleryFrames.forEach((frame, index) => {
        frame.addEventListener('click', () => {
          if (index === currentFrame) {
            // Open lightbox
            const src = frame.getAttribute('data-fullsize') || '';
            const title = frame.getAttribute('data-title') || '';
            openLightbox(src, title);
          } else {
            currentFrame = index;
            updateGallery();
          }
        });
      });

      // Keyboard navigation for gallery
      document.addEventListener('keydown', (e) => {
        const photographyPanel = document.getElementById('content-photography');
        if (photographyPanel?.hidden === false) {
          if (e.key === 'ArrowRight') {
            nextFrame();
          } else if (e.key === 'ArrowLeft') {
            prevFrame();
          }
        }
      });

      // Mouse wheel navigation
      const gallery3d = document.querySelector('.gallery-3d');
      let wheelTimeout: ReturnType<typeof setTimeout>;
      gallery3d?.addEventListener('wheel', (e) => {
        e.preventDefault();
        clearTimeout(wheelTimeout);
        wheelTimeout = setTimeout(() => {
          if ((e as WheelEvent).deltaY > 0) {
            nextFrame();
          } else {
            prevFrame();
          }
        }, 50);
      }, { passive: false });

      // Cinema functionality
      const cinemaScreens = document.querySelectorAll('.cinema-screen');
      const playButtons = document.querySelectorAll('.screen-play-btn');
      let currentCinemaIndex = 0;

      // Initialize first screen as active
      function updateCinemaScreens() {
        cinemaScreens.forEach((screen, index) => {
          if (index === currentCinemaIndex) {
            screen.classList.add('active');
          } else {
            screen.classList.remove('active');
            // Stop video when switching
            const videoContainer = screen.querySelector('.screen-video') as HTMLElement;
            const iframe = screen.querySelector('iframe');
            if (videoContainer && iframe) {
              videoContainer.hidden = true;
              iframe.src = '';
            }
            const thumbnail = screen.querySelector('.screen-thumbnail') as HTMLElement;
            const playBtn = screen.querySelector('.screen-play-btn') as HTMLElement;
            if (thumbnail) thumbnail.style.opacity = '1';
            if (playBtn) playBtn.style.display = 'flex';
          }
        });

        const cinemaIndexEl = document.getElementById('cinemaIndex');
        if (cinemaIndexEl) {
          cinemaIndexEl.textContent = String(currentCinemaIndex + 1);
        }
      }

      // Initialize cinema
      if (cinemaScreens.length > 0) {
        updateCinemaScreens();
      }

      // Play button click - start video
      playButtons.forEach((btn) => {
        btn.addEventListener('click', () => {
          const screen = btn.closest('.cinema-screen');
          if (!screen) return;

          const videoId = screen.getAttribute('data-video-id');
          const videoContainer = screen.querySelector('.screen-video') as HTMLElement;
          const iframe = screen.querySelector('iframe') as HTMLIFrameElement;
          const thumbnail = screen.querySelector('.screen-thumbnail') as HTMLElement;
          const playBtn = btn as HTMLElement;

          if (videoId && iframe) {
            // Set YouTube embed URL with autoplay
            iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;

            // Hide thumbnail and play button, show video
            if (thumbnail) thumbnail.style.opacity = '0';
            playBtn.style.display = 'none';
            if (videoContainer) videoContainer.hidden = false;
          }
        });
      });

      // Cinema navigation
      const cinemaPrev = document.getElementById('cinemaPrev');
      const cinemaNext = document.getElementById('cinemaNext');

      cinemaPrev?.addEventListener('click', () => {
        currentCinemaIndex = (currentCinemaIndex - 1 + cinemaScreens.length) % cinemaScreens.length;
        updateCinemaScreens();
      });

      cinemaNext?.addEventListener('click', () => {
        currentCinemaIndex = (currentCinemaIndex + 1) % cinemaScreens.length;
        updateCinemaScreens();
      });

      // Stop video when closing panel
      const originalClosePanel = closePanel;
      closePanel = function(goBack: boolean = false) {
        // Stop all cinema videos
        cinemaScreens.forEach((screen) => {
          const videoContainer = screen.querySelector('.screen-video') as HTMLElement;
          const iframe = screen.querySelector('iframe');
          if (videoContainer && iframe) {
            videoContainer.hidden = true;
            iframe.src = '';
          }
          const thumbnail = screen.querySelector('.screen-thumbnail') as HTMLElement;
          const playBtn = screen.querySelector('.screen-play-btn') as HTMLElement;
          if (thumbnail) thumbnail.style.opacity = '1';
          if (playBtn) playBtn.style.display = 'flex';
        });

        originalClosePanel(goBack);
      };
    </script>
  </body>
</html>
